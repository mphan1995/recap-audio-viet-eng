<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RECAP MAX - Audio Intelligence</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <div class="bg-grid"></div>
  <div class="orb orb-1"></div>
  <div class="orb orb-2"></div>
  <div class="orb orb-3"></div>

  <div class="shell">
    <header class="topbar">
      <div class="brand">
        <div class="logo">RM</div>
        <div class="brand-text">
          <div class="title">RECAP MAX</div>
          <div class="sub">Enterprise Audio Intelligence for English + Vietnamese</div>
        </div>
      </div>

      <div class="top-actions">
        <div class="status-inline" id="status">
          <span class="badge neutral">Idle</span>
          <span class="status-text">Ready to analyze audio.</span>
        </div>
        <button class="ghost" id="btnClear">Clear</button>
        <a class="ghost" href="#" id="btnDownloadJson" title="Download JSON" aria-disabled="true">Download JSON</a>
      </div>
    </header>

    <main class="grid">
      <section class="card stack">
        <div class="section-head">
          <h2>Audio Ingest</h2>
          <span class="tag">VI/EN Optimized</span>
        </div>

        <div class="dropzone" id="dropzone">
          <input type="file" id="audioFile" accept="audio/*" hidden />
          <div class="dz-inner">
            <div class="dz-icon">REC</div>
            <div class="dz-text">
              <div class="dz-head">Drop your audio here</div>
              <div class="dz-sub">or <span class="dz-link" id="pickFile">browse files</span> (mp3, wav, m4a...)</div>
            </div>
          </div>
          <div class="dz-meta" id="fileMeta">No file selected.</div>
        </div>

        <div class="form">
          <div class="row">
            <label>Language</label>
            <select id="language">
              <option value="auto">Auto (detect)</option>
              <option value="en">English</option>
              <option value="vi">Vietnamese</option>
            </select>
          </div>

          <div class="row">
            <label>Beam size</label>
            <input class="input" type="number" id="beamSize" min="1" max="10" value="5" />
          </div>

          <div class="row">
            <label>Speaker range</label>
            <div class="inline-inputs">
              <input class="input" type="number" id="minSpeakers" min="1" max="10" value="1" />
              <input class="input" type="number" id="maxSpeakers" min="1" max="10" value="5" />
            </div>
          </div>

          <div class="toggle-group">
            <label class="toggle">
              <input type="checkbox" id="diarization" checked />
              <span>Speaker diarization</span>
            </label>
            <label class="toggle">
              <input type="checkbox" id="gpt" checked />
              <span>GPT summary</span>
            </label>
            <label class="toggle">
              <input type="checkbox" id="vadFilter" />
              <span>VAD filter (ASR)</span>
            </label>
            <label class="toggle">
              <input type="checkbox" id="denoise" />
              <span>Noise reduction</span>
            </label>
            <label class="toggle">
              <input type="checkbox" id="trimSilence" />
              <span>Trim leading/trailing silence</span>
            </label>
            <label class="toggle">
              <input type="checkbox" id="normalize" />
              <span>Peak normalization</span>
            </label>
          </div>

          <button class="primary" id="startBtn">
            <span class="dot"></span>
            Start Analysis
          </button>

          <div class="progress hidden" id="progressWrap">
            <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
            <div class="progress-hint" id="progressHint">Processing...</div>
          </div>
        </div>

        <div class="hint-box">
          <div class="hint-title">Quality gate</div>
          <div class="hint-text">We flag excessive silence, clipping, and weak signal energy.</div>
        </div>
      </section>

      <section class="card results">
        <div class="card-head">
          <div>
            <h2>Results</h2>
            <div class="subtle" id="jobMeta">No job loaded.</div>
          </div>

          <div class="tabs" role="tablist">
            <button class="tab active" data-tab="summary" role="tab">Summary</button>
            <button class="tab" data-tab="transcript" role="tab">Transcript</button>
            <button class="tab" data-tab="metrics" role="tab">Metrics</button>
            <button class="tab" data-tab="json" role="tab">JSON</button>
          </div>
        </div>

        <div class="panel" id="panelEmpty">
          <div class="empty">
            <div class="empty-icon">*</div>
            <div class="empty-title">No results yet</div>
            <div class="empty-sub">Upload audio and click <b>Start Analysis</b>.</div>
          </div>
        </div>

        <div class="panel hidden" id="panelResult">
          <div class="stats" id="stats"></div>

          <div class="tabview" id="view-summary">
            <div class="summary" id="summary"></div>
          </div>

          <div class="tabview hidden" id="view-transcript">
            <div class="transcript" id="transcript"></div>
          </div>

          <div class="tabview hidden" id="view-metrics">
            <div class="metrics" id="metrics"></div>
            <div class="warnings hidden" id="warnings"></div>
          </div>

          <div class="tabview hidden" id="view-json">
            <pre class="code" id="json"></pre>
          </div>
        </div>
      </section>
    </main>

    <footer class="footer">
      <span>Built for a free, community-first audio intelligence platform.</span>
    </footer>
  </div>

  <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
