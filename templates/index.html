{% extends 'base.html' %}
{% block content %}
<section class="recap-wrapper">

  <!-- Upload + Config -->
  <div class="upload-card glass">
    <h2 class="title">ğŸ§ Analyze and Recap Audio</h2>

    <form id="uploadForm" class="config-grid">
      <div class="file-select">
        <input type="file" id="fileInput" name="audio" accept="audio/*" required>
        <label for="fileInput" class="file-label">
          <span id="fileLabelText">Choose your file (mp3/wav/m4a...)</span>
        </label>
        <button class="primary" type="submit">ğŸš€ Let's Analyze</button>
      </div>

      <div class="settings">
        <div>
          <label>Model</label>
          <select name="model" id="modelSelect"></select>
        </div>
        <div>
          <label>Compute</label>
          <select name="compute_type" id="computeSelect">
            <option>int8_float16</option>
            <option>int8</option>
            <option>float16</option>
            <option>float32</option>
          </select>
        </div>
        <div>
          <label>Beam size</label>
          <input type="number" min="1" max="10" value="5" name="beam_size" />
        </div>
        <div>
          <label>ASR language</label>
          <select name="asr_lang">
            <option value="auto">Auto</option>
            <option value="vi">Tiáº¿ng Viá»‡t</option>
            <option value="en">English</option>
          </select>
        </div>
        <div>
          <label>Summary language</label>
          <select name="lang" id="summaryLang">
            <option value="auto">Auto</option>
            <option value="vi">Tiáº¿ng Viá»‡t</option>
            <option value="en">English</option>
          </select>
        </div>
      </div>
    </form>

    <!-- Progress -->
    <div id="progress" class="progress hidden">
      <div class="progress-bar"></div>
      <span id="progressText">0%</span>
    </div>
    <div id="statusText" class="status-text"></div>
  </div>

  <!-- Player -->
  <div class="player-container hidden" id="playerContainer">
    <audio id="player" controls></audio>
  </div>

  <!-- Results -->
  <div id="results" class="results hidden">
    <div class="results-header">
      <h3>ğŸ“œ Káº¿t quáº£ phÃ¢n tÃ­ch</h3>
      <div class="export-buttons">
        <button onclick="downloadRecap('csv')">ğŸ“„ CSV</button>
        <button onclick="downloadRecap('excel')">ğŸ“Š Excel</button>
        <button onclick="downloadRecap('word')">ğŸ“ Word</button>
      </div>
    </div>

    <div class="grid-two">
      <div class="box">
        <h3>ğŸ—£ï¸ Transcript</h3>
        <pre id="transcript"></pre>
      </div>
      <div class="box">
        <h3>ğŸ§  Summary</h3>
        <pre id="summary"></pre>
      </div>
    </div>

    <!-- Meta -->
    <div class="meta">
      <div class="pill" id="mdl"></div>
      <div class="pill" id="dur"></div>
      <div class="pill" id="snr"></div>
      <div class="pill" id="lat"></div>
      <div class="pill" id="detLang"></div>
    </div>

    <!-- Segments -->
    <details class="segments-detail">
      <summary>ğŸ¬ Chi tiáº¿t tá»«ng Ä‘oáº¡n</summary>
      <table id="segmentsTable">
        <thead>
          <tr>
            <th>#</th><th>Báº¯t Ä‘áº§u</th><th>Káº¿t thÃºc</th><th>Ná»™i dung</th><th>Äá»™ tin cáº­y</th><th>Nghe láº¡i</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </details>
  </div>
</section>
{% endblock %}
